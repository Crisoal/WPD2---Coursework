<!DOCTYPE html>
<html>
<head>
 <title>Opportunities</title>
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>

<header>
        <nav class="navbar navbar-expand-md">
          <div class="container-fluid d-flex">
              <a class="navbar-brand" href="/">
                <img src="../public/images/Monochrome_Modern_Technology_Black_Logo-removebg-preview - Copy.png" alt="Logo" width="180" height="40" class="d-inline-block align-text-top">
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
      
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav ms-auto">
                  <li class="nav-item">
                      <a class="nav-link" href="/students/user/login">Mentorship Opportunities</a>
                  </li>

                  <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="/students/user/{{user_id}}/viewOpportunity">My Opportunities</a>
                  </li>

                  <li class="nav-item">
                        <a class="nav-link" href="/about">Find a Mentor</a>
                  </li>

                  <li class="nav-item">
                        <a class="nav-link" href="/about">My Goals</a>
                  </li>

                  <li class="nav-item">
                    <a class="nav-link" href="/contact">Profile</a>
                  </li>
      
              </ul>
            </div>

          </div>

        </nav>

</header>

 <h5>My Opportunities</h5>

<div class="container">
  <div class="row">
      {{#opportunities}}
      <div class="col-md-4">
          <div class="card mb-4 opportunity-card" data-opportunity-id="{{_id}}">
              <a href="/students/opportunityDetails/{{_id}}">
                 <div class="card-body">
                   <h2 class="card-title">{{title}}</h2>
                   <p class="card-text">{{description}}</p>
                 </div>
              </a>
              <div class="card-footer">
                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal" data-opportunity-id="{{_id}}">Remove</button>
              </div>
          </div>
      </div>
      {{/opportunities}}
  </div>
 </div>

 <!-- Delete Confirmation Modal -->
 <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
             <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
             <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
             Are you sure you want to delete this opportunity?
          </div>
          <div class="modal-footer">
             <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
             <form id="deleteForm" action="" method="POST" style="display: none;">
               <input type="hidden" name="_method" value="DELETE">
             </form>
             <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
          </div>
      </div>
  </div>
 </div>

<script>
  const deleteButtons = document.querySelectorAll('[data-bs-target="#deleteModal"]');
  deleteButtons.forEach(button => {
      button.addEventListener('click', (event) => {
          const opportunityId = button.getAttribute('data-opportunity-id');

          document.getElementById('deleteForm').action = `/students/viewOpportunity/removeOpportunity/${opportunityId}`;
      });
  });

  const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
  confirmDeleteBtn.addEventListener('click', () => {
      document.getElementById('deleteForm').submit();
  });

  // Prevent the anchor link from interfering with the modal
  const cardLinks = document.querySelectorAll('.opportunity-card .card-body a');
  cardLinks.forEach(link => {
      link.addEventListener('click', (event) => {
          event.preventDefault(); // Prevent the default link action
      });
  });
</script>


 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
